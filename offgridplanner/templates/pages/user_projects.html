{% extends 'base.html' %}

{% load static %}
{% load i18n %}

{% block head_block %}
<link href="{% static 'css/main.css' %}" rel="stylesheet">
{% endblock head_block %}


{% block content %}
<body>
<main>
  <section class="dashboard">
    <section class="dashboard" style="height: auto">
      <div class="chart"
           style="height: auto;
                      padding-bottom: 10px">
        <div class="chart__header">
          <a class="title">Projects</a>
          <div class="radio-inputs">
            <label class="radio">
              <input type="radio" name="radio" {% if status == "potential" %}checked{% endif %}>
              <a class="name" href="{% url 'projects:projects_list' 'potential' %}">Potential</a>
            </label>
            <label class="radio">
              <input type="radio" name="radio" {% if status == "analyzing" %}checked{% endif %}>
              <a class="name" href="{% url 'projects:projects_list' 'analyzing' %}">Analyzing</a>
            </label>
            <label class="radio">
              <input type="radio" name="radio" {% if status == "monitoring" %}checked{% endif %}>
              <a class="name" href="{% url 'projects:projects_list' 'monitoring' %}">Monitoring</a>
            </label>
          </div>

          <span style="float:right;"><a>
                    <a href="{% url 'steps:project_setup' %}"
                       class="btn btn--long text-right">{% translate "New Project" %}</a>
                  </a></span>
                </div>
                <span class="title"></span>
                <table id="projectTable">
                  <tr style="border-bottom:1px solid black">
                    <th>{% translate "ID" %}</th>
                    <th>{% translate "Project Name" %}</th>
                    <th>{% translate "Creation Date" %}</th>
                    <th>{% translate "Last Update" %}</th>
                    <th>{% translate "Model Status" %}</th>
                    <th></th>
                    <!-- Added an empty header for the new column -->
                    <th></th>
                    <th></th>
                    <th></th>
                  </tr>
                  {% if projects|length > 0 %}
                    {% for project in projects %}
                      <tr>
                        <td>{{ project.id }}</td>
                        <td>{{ project.name }}</td>
                        <td>{{ project.date_created }}</td>
                        <td>{{ project.date_updated }}</td>
                        <td>{{ project.simulation.status }}</td>
                        <td>
              <select class="status-select" data-original-status="{{ project.status }}">
                <option value="monitoring" {% if project.status == "monitoring" %}selected{% endif %}>Monitoring</option>
                <option value="analyzing" {% if project.status == "analyzing" %}selected{% endif %}>Analyzing</option>
                <option value="potential" {% if project.status == "potential" %}selected{% endif %}>Potential</option>
              </select>
            </td>

            <td>
                          <span style="float:right;">
                            <form action="{% url 'projects:project_duplicate' project.id %}"
                                  method="POST">
                              {% csrf_token %}
                              <button style="color:#1F567D;
                                             padding:4px"
                                      class="grey_button"
                                      type="submit"
                                      value="Duplicate">{% translate "Duplicate Project" %}</button>
                            </form>
                          </span>
            </td>
            <td>
            </td>
            <td>
                        <span style="float:right;">
                          <button class="grey_button">
                          <a onclick="document.getElementById('projectID{{ project.id }}').style.display='block'"
                             style="color:white">{% translate "Delete Project" %}</a>
                          </button>
                        </span>
            </td>
            <td>
                        <span style="float:right;">
                          <button class="grey_button">
                          <a href="{% url 'steps:project_setup' project.id %}">{% translate "Edit Project" %}</a>
                          </button>
                        </span>
            </td>
            <td>
                        <span style="float:right;">
                          <button class="grey_button">
                          <a href="{% url 'steps:simulation_results' project.id %}" >{% translate "Show Results" %}</a>
                          </button>
                        </span>
                      </td>
                    </tr>
                  {% endfor %}
                {% else %}
                  <tr>
                    <td>{% translate "You do not yet have any saved projects" %}</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <!-- Added an empty cell for the new column -->
                  </tr>
                {% endif %}
              </table>
              <span class="subtitle"></span>
            </div>
          </div>
        </div>
      </div>
      </div>
    </section>
    {% if projects|length > 0 %}
    {% for project in projects %}
    <div id=projectID{{ project.id }} class="modal">
      <form class="modal-content"
            action="{% url 'projects:project_delete' project.id %}"
            method="POST">
        {% csrf_token %}
        <div class="container">
          <h1>{% translate "Delete Project" %}</h1>
          <p>{% translate "Are you sure you want to delete the project?" %}</p>
          <div class="clearfix">
            <button style="margin-top:0.25rem;" class="deletebtn" type="submit">{% translate "Delete" %}</button>
            <button onclick="document.getElementById('projectID{{ project.id }}').style.display='none'"
                    type="button"
                    class="cancelbtn">{% translate "Cancel" %}</button>
          </div>
        </div>
      </form>
    </div>
    {% endfor %}
    {% endif %}
    <div id="projectExample"
         class="modal"
         style="background-color: rgba(0,0,0,0.5);
            z-index: 999;
            text-align: left">
  <form class="modal-content" style="max-width: 24rem">
    <div class="container">
      <h1>{% translate "Create Example Model" %}</h1>
      <p>{% translate "You have not created any projects yet. Would you like a sample project to be set up for you?" %}</p>
      <button onclick="create_example_project()" type="button" class="deletebtn">{% translate "Yes" %}</button>
      <button onclick="document.getElementById('projectExample').style.display='none'"
              type="button"
              class="deletebtn">{% translate "No" %}</button>
    </div>
  </form>
</div>
</section>
</main>
</body>
{% endblock content %}
{% block end_body_scripts %}
<script src="{% static 'js/pages/user_projects.js' %}"></script>
<script src="{% static 'js/backend_communication.js' %}"></script>
{% endblock end_body_scripts %}
